<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Developer's Guide</title>

    <!-- Bootstrap: CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />

    <!-- highlight.js -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/styles/stackoverflow-light.min.css"
      crossorigin="anonymous"
    />
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/highlight.min.js"></script>
    <script>
      hljs.highlightAll();
    </script>

    <!-- favicon -->
    <link rel="icon" href="../../favicon.ico" />
  </head>

  <body class="d-flex flex-column h-100">
    <header class="bg-primary py-3 mb-3 position-relative">
      <div class="container col-lg-8">
        <a href="../../">
          <h1 class="text-white">Automated API Validation Developer's Guide</h1>
        </a>
      </div>
    </header>

    <main class="container col-lg-8">
      <section id="project-setup">
        <h2>Project Setup</h2>
        <p>
          This section will walk you through how to go from a new computer with
          nothing installed to to being able to run the project.
        </p>

        <h4>Assumptions</h4>
        <p>
          This guide will assume that you are developing on a Windows machine.
          However, most of the steps <i>should</i> work on any OS. This guide
          will also assume that you are familiar with using the command line on
          your system.
        </p>

        <h4>Install Git</h4>
        <p>
          Download the proper version of Git for your system from
          <a href="https://git-scm.com/downloads"
            >https://git-scm.com/downloads</a
          >
          and run the installer. You can verify that Git is installed by running
          <code>git --version</code> on the command line. If you see something
          like <code>git version 2.31.1.windows.1</code>, then you have Git.
        </p>
        <p>
          Next, you should add your credentials to Git. These should be the same
          credentials you use to access GitHub. If you don't mind your
          credentials being stored locally on your machine in plain text, you
          can follow
          <a href="https://stackoverflow.com/a/35942890">this</a> answer from
          StackOverflow.
        </p>

        <h4>Install Python 3.9</h4>
        <p>
          Download Python from
          <a href="https://www.python.org/downloads/"
            >https://www.python.org/downloads/</a
          >
          and follow the instructions in the downloaded installer. Our project
          uses Python 3.9, but it might be worth checking if the libraries this
          project uses are compatible with a newer versions of Python. You can
          check your Python version by running <code>python --version</code>.
        </p>

        <h4>Clone the Project Repo</h4>
        <p>
          In your command line, navigate to the directory you'd like to contain
          the project. <code>git</code> is a popular choice. Then run the
          following command:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">git clone https://github.ncsu.edu/engr-csc-sdc/2021FallTeam01-Bandwidth.git</code></pre>
        <p>
          You should see a message letting you know that the repo was cloned
          into a folder called <code>2021FallTeam01-Bandwidth</code>.
        </p>

        <h4>Create a Virtual Environment</h4>
        <p>
          Virtual environments are a good way to manage Python libraries,
          especially if you have multiple projects or need to use multiple
          version of Python. Although it is not required, it is recommended that
          you create a virtual environment for your project. In your command
          line, navigate to the directory that contains your project (most
          likely
          <code>2021FallTeam01-Bandwidth</code>). Create a virtual environment
          with the following command:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">python -m venv [YOUR_VENV_NAME]</code></pre>
        <p>
          This will create a folder called <code>[YOUR_VENV_NAME]</code> that
          contains a copy of Python. You can activate the virtual environment by
          running the following command:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">[YOUR_VENV_NAME]/Scripts/activate</code></pre>

        <h4>Install Project Dependencies</h4>
        <p>
          Navigate the the project directory. If you used a virtual environment,
          make sure it is activated. Run the following commands:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">pip install -r requirements.dev.txt
pip install -r requirements.txt</code></pre>

        <h4>Run Tests</h4>
        <p>
          This final step will verify that you have successfully installed all
          of the dependencies. In your command line, navigate to the project
          root directory. If you used a virtual environment, make sure it is
          activated. Run the following command:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">coverage run -m pytest -vv</code></pre>
        <p>
          You should see some output listing every unit test and indicating that
          it passed. If you see that every unit test passed, you can run the
          following command to see a coverage report that lists which lines in
          each source file are not covered.
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">coverage report -m</code></pre>
      </section>

      <hr />

      <section id="github-actions-runner">
        <h2>GitHub Actions Runner</h2>
        <p>
          Currently, we use a self-hosted GitHub Actions runner to run our CI
          and integration tests. It's possible that in future years, GitHub
          Actions runners will be widely available to senior design students.
          Until that time comes, this section will walk you through how to set
          up a new runner.
        </p>

        <h4>Assumptions</h4>
        <p>
          This section will assume that you have obtained a x64 Ubuntu 20.04 VM
          from NCSU CSC IT. This section will assume that this VM has the proper
          ports open to communicate with GitHub. This section will assume that
          you have SSH'd into this VM and have
          <code>sudo</code> access.
        </p>

        <h4>Install Docker</h4>
        <p>
          Our action requires that the runner have Docker installed. Further,
          the GitHub actions runner software needs to be able to use Docker
          without sudo permissions. To accomplish this, run the following
          commands:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">sudo apt-get install docker.io
sudo usermod -a -G docker $USER</code></pre>

        <h4>Install Updates</h4>
        <p>
          Since CSC IT gives you a VM from an image they created a while ago,
          it's likely that you'll need to install some updates. Check for and
          install updates by running the following commands:
        </p>
        <pre class="text-center"><code class="language-bash">sudo apt-get update
sudo apt-get upgrade</code></pre>
        <p>
          If you see that the installed updates include kernel updates, you'll
          need to reboot the VM by running <code>sudo reboot</code> and SSH back
          in to the VM. Otherwise, the updates will not take effect.
        </p>

        <h4>Install Git</h4>
        <p>
          It's likely that Git is already installed on the VM. You can check by
          running <code>git --version</code>. If Git is not installed, you can
          install it on the command line by running the following command:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">sudo apt-get install git</code></pre>

        <h4>Install cURL</h4>
        <p>
          It's likely that cURL is already installed on the VM. You can check by
          running <code>curl --version</code>. If cURL is not installed, you can
          install it on the command line by running the following command:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">sudo apt-get install curl</code></pre>

        <h4>Install &amp; Run Runner Software</h4>
        <div class="alert alert-info" role="alert">
          <b>Info:</b> These instructions are taken from
          <a
            href="https://docs.github.com/en/actions/hosting-your-own-runners/adding-self-hosted-runners"
            >GitHub Actions Documentation</a
          >. You should read this documentation to find the latest version of
          the runner software to use. The commands below will be for the version
          our team uses at the time of writing.
        </div>
        <p>
          For each runner you need to create, make a folder for it by running
          <code>mkdir [RUNNER_FOLDER_NAME]</code>. Make sure that you are happy
          with the name and location of this folder, as changing either in the
          future can break the runner. Next, <code>cd</code> into this folder
          and run the following commands:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">curl -O -L https://github.com/actions/runner/releases/download/v2.283.3/actions-runner-linux-x64-2.283.3.tar.gz
tar xzf ./actions-runner-linux-x64-2.283.3.tar.gz
./config.sh --url [PROJECT_GITHUB_URL] --token [GITHUB_TOKEN]</code></pre>
        <p>
          <code>[GITHUB_TOKEN]</code> should have mostly likely given to you by
          the CSC 492 teaching staff. You should be taken through a menu where
          you need to enter information like a name for the runner. After
          completing this process, run the following commands to set up your
          runner as a service:
        </p>
        <pre
          class="text-center"
        ><code class="language-bash">sudo ./svc.sh install
sudo ./svc.sh start</code></pre>
        <p>
          See
          <a
            href="https://docs.github.com/en/actions/hosting-your-own-runners/configuring-the-self-hosted-runner-application-as-a-service"
            >GitHub's Documentation</a
          >
          for more information on having a runner as a service.
        </p>
        <div class="alert alert-danger" role="alert">
          <b>Security Consideration:</b> GitHub strongly recommends against
          having self-hosted runners on public (i.e. public to people even
          without NCSU credentials) GitHub repositories. This is because it
          could allow one to run dangerous code on your self-hosted runner. If
          this project's repository becomes public, you should use the
          <code>ubuntu-latest</code> runner provided by GitHub.
        </div>
      </section>
    </main>

    <footer class="mt-auto py-4 bg-primary">
      <div class="container">
        <p class="m-0 text-center text-white">
          &copy; 2021 William Boyles, Savan Doshi, Manali Shirsekar, and Sheldon
          Yao
        </p>
      </div>
    </footer>
  </body>
</html>
